---
title: "2_Data Normalization"
author: "yujia"
date: "2020年7月28日"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 1. 简介
在单细胞RNA测序数据中，常常可以观察到不同文库间序列覆盖范围的系统性差异;它们通常是由于不同细胞间cDNA捕获或PCR扩增效率的技术差异而产生的，这是由于很难用最少的起始材料实现一致的文库制备。 `Normalization` 的目的是消除这些差异，这样它们就不会干扰细胞间表达谱的比较; 这确保了任何观察到的异质性或细胞群体中的差异表达都是由生物学驱动的，而不是技术偏差导致。


`需要注意的是` 批次效应去除和normalization是两码事
`需要注意的是` 批次效应去除和normalization是两码事
`需要注意的是` 批次效应去除和normalization是两码事

`Normalization`与批次结构无关，并且只考虑技术偏差，而批次校正——顾名思义——只在批次之间发生，必须同时考虑技术偏差和生物差异。

技术偏差往往以类似的方式影响基因，或者至少以与基因生物物理特性相关的方式(例如，长度、GC内容)，而批次之间的生物差异可能是高度不可预测的

因此，这两个概念涉及到不同的假设，通常涉及到不同的计算方法(尽管有些包旨在同时执行两个步骤，例如zinbwave)。因此，重要的是要避免合并`Normalization`和`batch-corrected`数据，因为它们通常指不同的东西。

我们将主要关注缩放标准化，这是最简单和最常用的标准化策略类别。这涉及将每个单元格的所有计数除以特定于单元格的比例因子，通常称为“大小因子” （Anders和Huber 2010）。这里的假设是，任何特定于细胞的偏倚（例如，捕获或扩增效率）均会通过缩放该细胞的预期平均数来同等地影响所有基因。每个像元的大小因子代表该像元中相对偏差的估计，因此，将其计数除以其大小因子应消除该偏差。然后可以将所得的“规范化表达式值”用于下游分析，例如聚类和降维。为了演示，我们将使用Zeisel等。（2015）来自scRNAseq软件包的数据集

```{r}
library(scRNAseq)
sce.zeisel <- ZeiselBrainData()
```